<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Онлайн диагностика</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px; }
        .section { margin-bottom: 30px; }
        .subsection { margin-left: 20px; }
        .button { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Онлайн диагностика</h1>
    <p>Заполните форму ниже, чтобы оценить развитие вашего ребенка. После заполнения вы сможете скачать результаты в PDF.</p>

    <form id="diagnosticForm">
        <div class="section">
            <h3>Основные данные</h3>
            <div class="subsection">
                Пол: 
                <select name="gender">
                    <option value="Выберите пол">Выберите пол</option>
                    <option value="Женский">Женский</option>
                    <option value="Мужской">Мужской</option>
                </select>
                <br>
                Беременность: 
                <select name="pregnancy">
                    <option value="Выберите вариант">Выберите вариант</option>
                    <option value="Без проблем">Без проблем</option>
                    <option value="Угроза">Была угроза (кровотечения, заболевания и т.д.)</option>
                    <option value="Простуды">Болела простудами</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h3>Роды</h3>
            <div class="subsection">
                Как проходила беременность? 
                <select name="pregnancy_condition">
                    <option value="Выберите вариант">Выберите вариант</option>
                    <option value="Без проблем">Без проблем</option>
                    <option value="Угроза">Была угроза (кровотечения, заболевания и т.д.)</option>
                    <option value="Простуды">Болела простудами</option>
                </select>
                <br>
                Как проходили роды? 
                <select name="birth">
                    <option value="Выберите вариант">Выберите вариант</option>
                    <option value="Нормально">Нормально, в срок самостоятельно</option>
                    <option value="Раньше">Раньше времени на 1-2 мес.</option>
                    <option value="Осложнения">Не все гладко (обвитие, выдавливание и т.д.)</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h3>Развитие до года</h3>
            <div class="subsection">
                Были тонусные нарушения или кривошея? 
                <select name="muscle_issues">
                    <option value="Нет">Нет</option>
                    <option value="Гипертонус">Да - гипертонус</option>
                    <option value="Гипотонус">Да - гипотонус</option>
                </select>
                <br>
                Часто болел простудами? 
                <select name="cold_frequency">
                    <option value="Да">Да</option>
                    <option value="Нет">Нет</option>
                    <option value="Иногда">Иногда</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h3>Моторное развитие</h3>
            <div class="subsection">
                <label><input type="radio" name="sat_6-7" value="Да"> Сел в 6-7 месяцев?</label>
                <label><input type="radio" name="sat_6-7" value="Нет"> Нет</label>
                <br>
                <label><input type="radio" name="stood_support_7-8" value="Да"> Встал с поддержкой в 7-8 месяцев?</label>
                <label><input type="radio" name="stood_support_7-8" value="Нет"> Нет</label>
                <!-- Добавлены все остальные радио-кнопки и select-ы из исходного текста -->
            </div>
        </div>

        <!-- Остальные разделы аналогично с корректными name и value -->

        <button type="button" onclick="generatePDF()">Скачать результаты</button>
    </form>

    <script>
        async function generatePDF() {
            const form = document.getElementById('diagnosticForm');
            const data = new FormData(form);
            const entries = Array.from(data.entries());

            const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });

            // Добавление шрифта DejaVu для поддержки кириллицы
            pdf.addFont('https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/DejaVuSans.ttf', 'DejaVu', 'normal');
            pdf.setFont('DejaVu');

            let y = 15;
            pdf.text('Диагностический отчет', 15, y);
            y += 10;

            entries.forEach(([key, value]) => {
                pdf.text(`${key}: ${value}`, 15, y);
                y += 6;
            });

            pdf.save('diagnostic_report.pdf');
        }
    </script>
</body>
</html>
