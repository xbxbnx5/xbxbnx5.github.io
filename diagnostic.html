<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Онлайн-диагностика</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa, #e9ecef);
            color: #333;
            font-family: 'Open Sans', sans-serif;
            line-height: 1.8;
            padding: 40px;
            text-align: center;
        }
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5em;
            color: #487eb0;
            margin-bottom: 30px;
        }
        form {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .question {
            margin-bottom: 25px;
            text-align: left;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #487eb0;
        }
        input[type="radio"] {
            margin-right: 10px;
        }
        .btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, #a8d5e2, #74c7d5);
            color: #fff;
            text-decoration: none;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            box-shadow: 0 6px 20px rgba(116, 199, 213, 0.4);
            cursor: pointer;
            transition: all 0.4s ease;
        }
        .btn:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(116, 199, 213, 0.6);
        }
        @media (max-width: 768px) {
            h1 { font-size: 2em; }
            form { padding: 20px; }
        }
    </style>
</head>
<body>
    <h1>Онлайн-диагностика</h1>
    <form id="diagnostic-form">
        <div class="question">
            <label>1. Ваш ребенок часто отвлекается и не может сосредоточиться на задании?</label>
            <input type="radio" name="q1" value="Да"> Да
            <input type="radio" name="q1" value="Нет"> Нет
        </div>
        <div class="question">
            <label>2. Ребенок избегает зрительного контакта?</label>
            <input type="radio" name="q2" value="Да"> Да
            <input type="radio" name="q2" value="Нет"> Нет
        </div>
        <div class="question">
            <label>3. Ребенок часто повторяет одни и те же действия или слова?</label>
            <input type="radio" name="q3" value="Да"> Да
            <input type="radio" name="q3" value="Нет"> Нет
        </div>
        <div class="question">
            <label>4. Ваш ребенок плохо реагирует на изменения в распорядке дня?</label>
            <input type="radio" name="q4" value="Да"> Да
            <input type="radio" name="q4" value="Нет"> Нет
        </div>
        <div class="question">
            <label>5. Ребенок испытывает трудности с речью (мало говорит, нечетко произносит)?</label>
            <input type="radio" name="q5" value="Да"> Да
            <input type="radio" name="q5" value="Нет"> Нет
        </div>
        <button type="submit" class="btn">Сохранить результаты в PDF</button>
    </form>

    <script>
        // Проверка доступа через localStorage
        const validIdentifiers = [
            'f172b4e7-b79e-4e83-aec1-a719f377aa48', 'fec42f34-7e7b-4992-b0b1-b7245e477f5d',
            'cc85ea48-a6b2-4547-a8d6-48e3815d32a1', '70142591-b33a-4529-9c90-001b6fc531b7',
            'c245e5e2-cf68-48b5-94d8-fcc11f228605', 'f5743da7-b3f3-4e79-83fd-cab0e467fa54',
            '7ff3e0fb-4b09-4db6-8566-5974c9fe4dfc', '0074ee6d-c0b3-4cd5-8a68-af36ccf89a83',
            '99b31d59-2eff-496f-99e2-a70c5826edb5', 'a7611979-847c-4f09-8aba-a31b8e5d0131',
            '49cf00ad-f6d6-45a8-802f-bc7308a75215', '0c9074ea-617f-44d0-8991-6169da73cf65',
            'c6ea0993-1ca7-4a49-a2a2-b51a73df4466', '498ec386-10b9-4aa8-9bf6-895cb994133e',
            '7e4cc55f-d89c-461d-af96-a4f11ec724c2', '932b1450-d24f-4238-abd8-28be9d19ca1c',
            '10c4b9bc-528d-4813-aed4-ff7ccbd3511b', '0be40d49-39e2-40fb-bf37-7f2d75467f75',
            '55b4cef6-e066-4450-a418-0e726fafe869', 'f55370d2-13ac-42a5-908d-ee4060961aea',
            'cd2239d2-e9a0-40dc-a141-fa9595429eb0', '09d76932-17d8-4e5e-9fbe-4619c53ab1b6',
            'b55c9cc1-ae08-4444-9549-5b5fc5dcdcce', '0474f204-df20-4926-8b29-810dfa2b32c3',
            '02172484-62a0-49be-ae8f-9505992e2944', '9e64309c-ac0a-4b22-a1ec-a8d2186ba781',
            '27f6da80-522b-4439-b090-ee1826575ed7', '06dec1d3-7958-4471-8645-d5c23e8ff1fd',
            '9f0ab6f2-4119-491c-8bb1-88ef23b02a54', '0adbcd70-4f9d-4a8a-bb76-e6ce192c9e06',
            'a474b86e-b26d-468e-9e70-8990104bca5e', '5fbd6980-c917-4298-bf74-97801084bd5a',
            'ecdfcfd9-e33d-423d-a380-6f1f62cc3820', '1c1bc7de-a57a-4f59-9d41-3285b427dd86',
            '30eee851-3b19-46a1-8ba7-80687a4565a3', 'a57755fc-929b-4ef0-8ce2-10bbe669df78',
            '489dc6c2-4140-468e-8e07-84c99518fd3f', '1d080905-86b0-46bf-a5eb-7b98e7bf2e3b',
            '1ec8ba02-f5b6-495c-8d77-265b9d7ca875', 'f3c4c61a-76a0-4635-9a92-6dd4bbd90f5b',
            'dde76267-cd0d-43ca-bd68-856112e3836a', 'aaf0f0e4-9b8f-413b-b093-7fb812fe1b04',
            '1eeca7d5-6f25-4b82-a578-af4ba91ca8e6', 'fa40b441-158d-4b79-bc20-f3b618b87a92',
            'cbeb6215-754b-44b3-9b40-01c3c9e89c10', '2cfe1d17-d26a-4654-a401-979c46b394ad',
            '9eec7a7b-2621-4010-a129-0111241ea9bf', 'e6076433-9803-4975-a8ce-2f1185649069',
            '2b70e878-a46f-4dcc-b4e7-5aa891bd4081', '2f9c679f-11fd-4933-a2db-6c0ce45780e3'
        ];

        // Проверка доступа
        const storedIdentifier = localStorage.getItem('diagnosticAccess');
        if (!storedIdentifier || !validIdentifiers.includes(storedIdentifier)) {
            alert('Доступ запрещен. Пожалуйста, введите корректный идентификатор на главной странице.');
            window.location.href = 'index.html';
        }

        // Обработка формы и генерация PDF
        document.getElementById('diagnostic-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            let results = 'Результаты диагностики:\n\n';
            results += '1. Ваш ребенок часто отвлекается и не может сосредоточиться на задании? ' + (formData.get('q1') || 'Не указано') + '\n';
            results += '2. Ребенок избегает зрительного контакта? ' + (formData.get('q2') || 'Не указано') + '\n';
            results += '3. Ребенок часто повторяет одни и те же действия или слова? ' + (formData.get('q3') || 'Не указано') + '\n';
            results += '4. Ваш ребенок плохо реагирует на изменения в распорядке дня? ' + (formData.get('q4') || 'Не указано') + '\n';
            results += '5. Ребенок испытывает трудности с речью (мало говорит, нечетко произносит)? ' + (formData.get('q5') || 'Не указано') + '\n';

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Добавляем шрифт с поддержкой кириллицы (Roboto)
            doc.addFileToVFS('Roboto-Regular.ttf', 'data:font/truetype;charset=utf-8;base64,<base64-encoded-font-data>');
            doc.addFont('Roboto-Regular.ttf', 'Roboto', 'normal');
            doc.setFont('Roboto');

            // Устанавливаем шрифт и добавляем текст
            doc.setFontSize(12);
            doc.text(results.split('\n'), 10, 10);

            // Сохранение PDF
            doc.save('Результаты_диагностики.pdf');
        });
    </script>
</body>
</html>
